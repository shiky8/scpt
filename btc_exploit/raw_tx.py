#!/bin/python_3.9

from typing import Dict
from urllib.request import Request, urlopen
import subprocess as sp
import os,ssl
class Get_RAW_TX():

    def __init__(self) -> None:
        ssl._create_default_https_context = ssl._create_unverified_context
        pass

    def raw_txt(self,TxId: str) -> str:
        url: str = 'https://blockchain.info/rawtx/' + TxId + '?format=hex'
        header: Dict[str, str] = {
            "User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0"
        }
        req1 = Request(url, headers=header)
        RowTx: str = urlopen(req1).read().decode()
        if "nt" in os.name:
                dirk: str = str(sp.getoutput('powershell pwd'))
                dirk = dirk.replace(" ","").replace("\r","").replace("\n","").replace("'","").replace("Path","").replace("--","")
                if "\\btc_exploit" not in dirk:
                    dirk  += "\\btc_exploit"
                dirk = dirk.replace('\\btc_exploit', '\\Reports\\btc_exploit_Repo\\')
        else:
            dirk: str = str(sp.getoutput('pwd'))
            if "/btc_exploit" not in dirk:
                dirk +="/btc_exploit"
            dirk = dirk.replace('/btc_exploit', '/Reports/btc_exploit_Repo/')
        with open(dirk + TxId + "_BTC_RowTxID.json","a") as dop:
            dop.write(str(RowTx))
            dop.write("\n")
            dop.close()
        return RowTx

if __name__ == "__main__":
    TxId: str = "9ec4bc49e828d924af1d1029cacf709431abbde46d59554b62bc270e3b29c4b1"
    RX = Get_RAW_TX()
    RX_Output: str = RX.raw_txt(TxId)
    print(RX_Output)
